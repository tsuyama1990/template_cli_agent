# CYCLE02/UAT.md

## 1. Test Scenarios

User Acceptance Testing (UAT) for Cycle 2 focuses on verifying the new generative capabilities of the MLIP-AutoPipe system. The central user story for this cycle is: "As a computational materials scientist, I want to define a material using only its chemical formula in a simple file, and have the system automatically figure out the right settings, generate a good set of initial atomic structures, and train a baseline MLIP without any further intervention." This UAT will be conducted via a Jupyter Notebook (`uat_cycle02.ipynb`) that demonstrates this "zero-to-first-model" workflow, emphasizing the user experience of minimal input and maximal automation.

| Scenario ID | Scenario Description                                                                | Priority |
| :---------- | :---------------------------------------------------------------------------------- | :------- |
| UAT-C02-01  | **Verify Minimal Input Workflow**                                                   | High     |
|             | The user will create a minimal `input.yaml` file containing only the elements and composition for a binary alloy (e.g., Copper-Gold, "CuAu"). They will run the main CLI command and verify that the entire `Generate -> Label -> Train` workflow completes successfully and produces all expected artifacts, demonstrating the full automation from just the chemical formula. |          |
| UAT-C02-02  | **Validate Heuristic Configuration Expansion**                                      | High     |
|             | The user will inspect the `exec_config_dump.yaml` file that is automatically generated by the system. They will verify that the heuristic engine correctly inferred the material type as "alloy" and populated the configuration with sensible DFT parameters (e.g., reasonable pseudopotential cutoffs and k-point densities). This test builds confidence in the system's "expert knowledge" capabilities. |          |
| UAT-C02-03  | **Validate Generated Structure Diversity**                                          | Medium   |
|             | The user will connect to the generated ASE database and inspect the initial structures created by `Module A`. They will verify that the database contains not just a single structure, but a diverse set of structures, including different random arrangements (from SQS) and various volumetric strains. The goal is to confirm that the system is generating a rich dataset suitable for training a robust potential. |          |

## 2. Behavior Definitions

The behavior of the system will be defined using the Gherkin-style (GIVEN/WHEN/THEN) syntax. These definitions will be implemented as interactive steps within the `uat_cycle02.ipynb` notebook.

### Scenario: UAT-C02-01 - Verify Minimal Input Workflow

*   **GIVEN** a clean working directory.
*   **AND** the user has created a minimal configuration file named `input.yaml` with the content specifying a CuAu alloy (e.g., `system: {elements: ["Cu", "Au"], composition: "CuAu"}`).
*   **WHEN** the user executes the main CLI command `uv run mlip-pipe run --input input.yaml` in the terminal.
*   **THEN** the command should execute and finish without raising any unhandled exceptions, returning an exit code of 0.
*   **AND** the system should print informative log messages indicating the successful completion of the "Config Expansion", "Structure Generation", "Labeling", and "Training" stages.
*   **AND** three new files should be present in the working directory: `exec_config_dump.yaml`, an ASE database (e.g., `mlip_autopipec.db`), and the trained model artifact (`trained_model.pt`).

### Scenario: UAT-C02-02 - Validate Heuristic Configuration Expansion

*   **GIVEN** the successful completion of the workflow from scenario UAT-C02-01.
*   **AND** the user has loaded the `exec_config_dump.yaml` file within the Jupyter Notebook.
*   **WHEN** the user inspects the contents of the parsed YAML file.
*   **THEN** the `system` section should contain the field `structure_type: "alloy"`, which was correctly inferred by the heuristic engine.
*   **AND** the `dft_compute` section should be fully populated with specific, numeric values for parameters like `ecutwfc`, `ecutrho`, and `kpoints_density`.
*   **AND** the `generation` section should be present and contain a default strategy, such as `generation_strategy: "sqs"`.
*   **AND** the values for the DFT cutoffs should be reasonable for the Cu-Au system (e.g., `ecutwfc` should be greater than 50 Ry, reflecting the value needed for the Au pseudopotential).

### Scenario: UAT-C02-03 - Validate Generated Structure Diversity

*   **GIVEN** the successful completion of the workflow from scenario UAT-C02-01.
*   **AND** the user has connected to the generated ASE database (`mlip_autopipec.db`) within the Jupyter Notebook.
*   **WHEN** the user queries the database to retrieve all stored atomic structures.
*   **THEN** the database should contain more than one structure (e.g., at least 5 structures).
*   **AND** the structures should all have the correct chemical composition (equal numbers of Cu and Au atoms).
*   **AND** the structures should have different volumes, corresponding to the different lattice strains applied during the generation process. The user will verify this by printing the `cell.volume` for each structure.
*   **AND** the notebook will visually render a few of the generated structures, allowing the user to confirm that they represent different atomic arrangements.
