# CYCLE02 User Acceptance Test: Advanced Features and Web UI

## 1. Test Scenarios

This document outlines the User Acceptance Testing (UAT) for the deliverables of Cycle 2. This cycle introduces two major areas of new functionality: a user-friendly Web UI for interactive workflow management, and advanced scientific capabilities in the backend pipeline. The UAT is therefore split into two distinct scenarios to validate each of these areas. The goal is to ensure the new features are not only technically functional but also provide a seamless and powerful user experience.

| Scenario ID | Priority | Description                                                                                                                                                              |
| :---------- | :------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| UAT-C2-001  | High     | **Interactive Pipeline Configuration and Execution via Web UI.** A user can configure, launch, monitor, and inspect the results of a complete pipeline run using only their web browser.      |
| UAT-C2-002  | Medium   | **Advanced Exploration and Sampling via CLI.** A power user can leverage the new hybrid MD/MC exploration and Farthest Point Sampling (FPS) features from the command line to generate a higher quality dataset. |

**UAT Approach:**
Similar to Cycle 1, the UAT will be presented in the form of Jupyter Notebooks.

*   **`UAT_CYCLE02_WebUI.ipynb`**: This notebook will focus on scenario UAT-C2-001. It will not execute the code directly but will contain screenshots and step-by-step instructions for the user to follow in their web browser. It will guide them through starting the Streamlit server, interacting with the UI widgets, launching a run, and observing the outcome. It will then provide Python code snippets to programmatically verify the database created by the UI-initiated run. This approach validates the primary user journey for the new interface.

*   **`UAT_CYCLE02_AdvancedCLI.ipynb`**: This notebook will be an executable tutorial for scenario UAT-C2-002. It will be very similar in structure to the Cycle 1 UAT notebook but will use a configuration file that explicitly enables the new scientific features. This allows a direct, scriptable validation of the backend enhancements and serves as documentation for power users on how to leverage these new capabilities.

## 2. Behavior Definitions

This section provides Gherkin-style definitions for the expected behavior of the two primary test scenarios.

---

### **Scenario: UAT-C2-001 - Interactive Pipeline Configuration and Execution via Web UI**

**Feature:** Web-based User Interface

**As a** Researcher new to computational materials science,
**I want to** use an intuitive graphical interface to set up and run my dataset generation workflow,
**So that** I can leverage the power of the tool without needing deep command-line expertise.

---

**GIVEN** a clean project environment with the `mlip-autopipec` package and its web dependencies (`streamlit`) installed.

**AND** I have launched the web application by running `streamlit run src/mlip_autopipec/web_ui.py` in my terminal.

**WHEN** I navigate to the provided local URL in my web browser.

**THEN** I should see a web page titled "MLIP-AutoPipe Web UI".

**AND** the page should display a set of interactive widgets in a sidebar for configuration, including:
*   A text input for "Elements"
*   A text area for "Composition"
*   A dropdown for "Crystal Structure"
*   A slider for "Temperature"

**WHEN** I fill out the form with values for a simple system (e.g., Elements: "Si", Composition: "Si: 1.0", Crystal Structure: "diamond", Temperature: 300K).

**AND** I click the "Run Pipeline" button.

**THEN** the main area of the page should display a log panel.

**AND** the log panel should begin to show real-time output from the backend process, indicating that the pipeline stages are running.

**AND** after some time, the log panel should display the message "Pipeline completed successfully."

**AND** the web page should present a "Download Database" button.

**WHEN** I click the "Download Database" button.

**THEN** my browser should download a file named `generated_dataset.db`.

**AND** this downloaded database file should be a valid ASE database that can be connected to and queried, containing the structures generated by the pipeline run.

---

### **Scenario: UAT-C2-002 - Advanced Exploration and Sampling via CLI**

**Feature:** Advanced Scientific Pipeline Features

**As an** Expert MLIP Developer,
**I want to** enable advanced physics and sampling methods in my workflow,
**So that** I can create a more diverse and physically robust dataset that covers difficult regions of the potential energy surface.

---

**GIVEN** a clean project environment with the `mlip-autopipec` package installed.

**AND** I have created a Hydra configuration file `conf/advanced_config.yaml` with the following content, enabling hybrid MD/MC and Farthest Point Sampling:
```yaml
# conf/advanced_config.yaml
defaults:
  - _self_

system:
  type: "Alloy"
  elements: ["Ni", "Ti"]
  composition: {"Ni": 0.5, "Ti": 0.5}
  crystal_structure: "fcc"
  num_initial_structures: 1

exploration:
  temperature_k: 1500.0 # High temperature to see effects
  num_steps: 100
  calculator: "EMT"
  mc_moves:
    enabled: True
    swap_frequency: 10 # Attempt an atom swap every 10 steps

sampling:
  method: "FPS" # Use Farthest Point Sampling
  num_samples: 10

db_path: "results/niti_advanced_dataset.db"
```

**WHEN** I execute the following command in my terminal:
`mlip-autopipec run --config-path conf --config-name advanced_config`

**THEN** the program should execute successfully without errors.

**AND** the log output should confirm that the advanced features are active (e.g., messages like "Attempting MC swap move..." or "Calculating SOAP descriptors for FPS...").

**AND** a database file should be created at `results/niti_advanced_dataset.db`.

**AND** when I inspect the database, it should contain 10 structures.

**AND** if I were to visualize the structures in the database, their atomic positions and compositions should be qualitatively different from each other, reflecting the diversity sought by the FPS algorithm and the configurational changes introduced by the MD/MC simulation.
